{"ast":null,"code":"import React,{createContext,useState,useEffect,useContext}from'react';import{login as loginAPI,register as registerAPI,getMe}from'../services/api';import{toast}from'react-toastify';// Create AuthContext\nimport{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();// Custom hook to use AuthContext\nexport const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};// AuthProvider component\nexport const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);// Check if user is already logged in on mount\nuseEffect(()=>{const checkAuth=async()=>{const token=localStorage.getItem('token');if(token){try{const{data}=await getMe();setUser(data);}catch(error){console.error('Failed to fetch user:',error);localStorage.removeItem('token');setUser(null);}}setLoading(false);};checkAuth();},[]);const login=async(email,password)=>{try{const{data}=await loginAPI({email,password});localStorage.setItem('token',data.token);setUser(data.user||data);toast.success('Login successful!');return true;}catch(error){var _error$response,_error$response$data;console.error('Login error:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Login failed');return false;}};const register=async(name,email,password)=>{try{const{data}=await registerAPI({name,email,password});localStorage.setItem('token',data.token);setUser(data.user||data);toast.success('Registration successful!');return true;}catch(error){var _error$response2,_error$response2$data;console.error('Registration error:',error);toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Registration failed');return false;}};const logout=()=>{localStorage.removeItem('token');setUser(null);toast.info('Logged out successfully');};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,login,register,logout},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","login","loginAPI","register","registerAPI","getMe","toast","jsx","_jsx","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","user","setUser","loading","setLoading","checkAuth","token","localStorage","getItem","data","error","console","removeItem","email","password","setItem","success","_error$response","_error$response$data","response","message","name","_error$response2","_error$response2$data","logout","info","Provider","value"],"sources":["/Users/malith_bandara/Desktop/AI-Dress-Mart/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { login as loginAPI, register as registerAPI, getMe } from '../services/api';\nimport { toast } from 'react-toastify';\n\n// Create AuthContext\nexport const AuthContext = createContext();\n\n// Custom hook to use AuthContext\nexport const useAuth = () => {\n    const context = useContext(AuthContext);\n    if (!context) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n};\n\n// AuthProvider component\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    // Check if user is already logged in on mount\n    useEffect(() => {\n        const checkAuth = async () => {\n            const token = localStorage.getItem('token');\n            if (token) {\n                try {\n                    const { data } = await getMe();\n                    setUser(data);\n                } catch (error) {\n                    console.error('Failed to fetch user:', error);\n                    localStorage.removeItem('token');\n                    setUser(null);\n                }\n            }\n            setLoading(false);\n        };\n\n        checkAuth();\n    }, []);\n\n    const login = async (email, password) => {\n        try {\n            const { data } = await loginAPI({ email, password });\n            localStorage.setItem('token', data.token);\n            setUser(data.user || data); \n            toast.success('Login successful!');\n            return true;\n        } catch (error) {\n            console.error('Login error:', error);\n            toast.error(error.response?.data?.message || 'Login failed');\n            return false;\n        }\n    };\n\n    const register = async (name, email, password) => {\n        try {\n            const { data } = await registerAPI({ name, email, password });\n            localStorage.setItem('token', data.token);\n            setUser(data.user || data);\n            toast.success('Registration successful!');\n            return true;\n        } catch (error) {\n            console.error('Registration error:', error);\n            toast.error(error.response?.data?.message || 'Registration failed');\n            return false;\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('token');\n        setUser(null);\n        toast.info('Logged out successfully');\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, loading, login, register, logout }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}